

This is a Python 2 based suite of tools for analysing SOLiD or Illumina
sequencing reads with poly(A) tails.

Use of PyPy is recommened for speed.


License:
========

This software is distributed under the terms of the GPL, version 2 or later,
excepting that:

- The third party javascript libraries included for convenience
  in directory tail_tools/web/third_party are covered by the terms of
  their respective licenses (also in that directory).

- The remaining files in the directory tail_tools/web are placed in the
  public domain.


Requirements:
=============

- "nesoni", available from http://vicbioinformatics.com/nesoni.shtml or using

    pip install nesoni

  You don't need to install all of nesoni's dependencies, just Python 2.7 
  or later or PyPy.

- bowtie2
  (SHRiMP for legacy color-space data)

- The "convert" tool from ImageMagick.

- rsync (for downloads from UCSC browser)


Installation:
=============

Easy way:

  pip install tail-tools

From source:

  python setup.py install

For PyPy it seems to be currently easiest to set up in a virtualenv:

  virtualenv -p pypy myenv
  myenv/bin/pip install tail-tools


Usage:
======

This package contains a number of tools, which can be listed by typing:

  tail-tools
  

The package can be used directly from the source directory with:

  python -m tail_tools


These tools may also be used as part of a nesoni-style workflow python script.





Peak calling and statistics:
============================

tail-tools call-peaks: peaks $SAMPLES_POLYA \
    --types gene --shift-start 0 --shift-end 1000
#
#  --shift-end should be chosen appropriate to the genome
#

tail-tools analyse-tail-lengths: myanalysis $SAMPLES_ALL \
    --annotations peaks/relation-child.gff --types peak \
    --saturation 0 --make-do all
#
#  --saturation 1 to de-duplicate alignments
#


tail-tools compare-peaks: mycomparison $REFERENCE \
    peaks/relation-parent.gff peaks/relation-child.gff myanalysis-counts.csv

tail-tools geneview-webapp: geneviewer




Reference format
================

Before processing any reads, you need to create a "tail-tools reference directory".

References are most easily downloaed from the UCSC browser using:

   tail-tools make-ucsc-reference: \
       <output_dir> \
       <ucsc_reference_name> \
       --extension <extension_length>

If creating your own reference, it needs to consist of:

- sequences, eg in FASTA format
- annotations in GFF3 format

The reference directory is then created with the command:

  tail-tools make-tt-reference: \
      <output_dir> \
      <sequence_file> \
      <annotations_file> \
      --extension <extension_length>

--extension determines how far downstrand of a gene a read (or peak) can be and 
still be counted as belonging to that gene.

Annotations shall include the following feature types and attributes:

gene
    required attributes:
    - ID      - unique identifier
    optional attributes:
    - Name    - nomenclature name
    - Product - short description

mRNA
    required attributes:
    - ID      - unique identifier
    - Parent  - gene ID

CDS
    required attributes:
    - Parent  - mRNA ID

exon
    required attributes:
    - Parent  - mRNA ID




GTF appears to be the standard used by
htseq
cufflinks etc


iGenomes as a data source?


produces 
reference.gff           - GFF3 file, mRNA attributes have group attribute refers to reference-collapsed.gff
reference-collapsed.gff - 
reference-3utr.gff      - 3' UTR regions of collapsed genes 




















